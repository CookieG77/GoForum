{{ define "content" }}

{{ if .ComingFromMail }}
    <p>Please enter your new password !</p>
    <form action="/reset-password" method="post">
        <input type="hidden" name="formType" value="submitPassword">
        <input type="hidden" name="token" value="{{ .MailToken }}">
        {{ if eq .Error "emptyFields" }}
            <p>Some fields were left empty</p>
        {{ end }}
        {{ if eq .Error "passwordsMismatch" }}
            <p>Passwords do not match</p>
        {{ end }}
        {{ if eq .Error "passwordIncorrect" }}
            <p>Password is too short</p>
        {{ end }}
        <label>
            <input type="password" id="change_password_password" required name="password" placeholder="Enter your new password here">
        </label>
        <label>
            <input type="password" id="change_password_confirm_password" required name="passwordConfirm" placeholder="Confirm your new password here">
        </label>
        <button type="submit" id="change_password_button">Change password</button>
        {{ if .Success }}
            <p>Password was changed !</p>
            <p>You will be redirected to the home page in <span id="redirect_msg">3</span></p>
            <script>
                document.getElementById("change_password_password").disabled = true;
                document.getElementById("change_password_confirm_password").disabled = true;
                document.getElementById("change_password_button").disabled = true;
                setTimeout(() => {
                    document.getElementById("redirect_msg").innerText = "2";
                }, 1000);
                setTimeout(() => {
                    document.getElementById("redirect_msg").innerText = "1";
                }, 2000);
                setTimeout(() => {
                    window.location.href = "/";
                }, 3000);
            </script>
        {{ end }}
    </form>
{{ else }}
    <p>You wish to reset your password ? Please provide the email attached to your account here !</p>
    {{ if eq .Error "noMailProvided" }}
        <p>No email were provided, stop messing with the html page !!!</p>
    {{ end }}
    {{ if eq .Error "linkedToOAuth" }}
        {{ if eq .Provider "google" }}
            <p>It seems that your account is linked to a Google account</p>
        {{ end }}
        {{ if eq .Provider "github" }}
            <p>It seems that your account is linked to a GitHub account</p>
        {{ end }}
        {{ if eq .Provider "discord" }}
            <p>It seems that your account is linked to a Discord account</p>
        {{ end }}
        <p>You cannot reset the password of an account registered with another website</p>
    {{ end }}
    <form action="/reset-password" method="post">
        <input type="hidden" name="formType" value="submitMail">
        <label>
            <input type="email" required name="email" placeholder="Enter your email here">
        </label>
        <button type="submit">Send me a reset link</button>
    </form>
    {{ if .Success }}
        <p>Email was sent !</p>
    {{ end }}
{{ end }}

{{ end }}